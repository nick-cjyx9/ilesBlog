const c=document;let r,u=location.pathname;const i=navigator.connection,S=i&&(i.saveData||/2g/.test(i.effectiveType)),s=Array.from,h=(t,e=c)=>s(e.querySelectorAll(t)),d=t=>c.adoptNode(t),l=(t="link")=>c.createElement(t),_=window.requestIdleCallback||setTimeout,p=t=>new URL(t,location.href).pathname,y=(t,e="high")=>fetch(t,{credentials:"include",importance:e}),g=C()?D:t=>y(t,"low"),f=new Set;f.add(p(location.href));function I(t){!S&&!f.has(t)&&(f.add(t),g(t))}w();addEventListener("popstate",t=>{u!==location.pathname&&v(location.href,t.state&&t.state.scrollPosition||0)});function w(){window.__ILE_DISPOSE__=new Map,r==null||r.disconnect(),r=new IntersectionObserver(t=>{t.forEach(({target:e,isIntersecting:o})=>{o&&(r.unobserve(e),e.addEventListener("click",P),I(p(e.href)))})}),_(()=>{h("a").forEach(t=>{const e=t.pathname.match(/\.\w+$/);(!e||e[0]===".html")&&t.hostname===location.hostname&&r.observe(t)})})}function P(t){const e=t.target.closest("a");if(!t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey&&event.which<=1&&e.target!=="_blank"){const o=e.pathname===location.pathname,n=e.hash===location.hash;(!o||n)&&t.preventDefault(),o||v(e.href,0,()=>{history.replaceState({scrollPosition:scrollY},c.title),history.pushState(null,"",e.href)})}}function v(t,e,o){t=p(t),y(t).then(n=>n.text()).then(n=>{o==null||o(),u=location.pathname,b(n),scrollTo(0,e||c.querySelector(location.hash||"body").offsetTop),w()}).catch(n=>{console.error(n),location.href=t})}function b(t){const{head:e,body:o}=new DOMParser().parseFromString(t,"text/html"),n=c.head;h(':not(link[rel="stylesheet"]):not(style)',n).forEach(a=>a.remove());const E=new Set(h("link",n).map(a=>a.href));s(e.children).forEach(a=>{(a.tagName!=="LINK"||a.rel!=="stylesheet"||!E.has(a.href))&&(d(a),n.appendChild(a))}),d(o),s(__ILE_DISPOSE__).forEach(([a,L])=>L()),c.body.replaceWith(o),m(e),m(o)}function m(t){h("script",t).forEach(A)}function A(t){if(t.getAttribute("once")===null){const e=l("script");s(t.attributes).forEach(o=>e.setAttribute(o.nodeName,o.nodeValue)),e.textContent=t.textContent,t.replaceWith(e)}}function C(t){return t=l(),t.relList&&t.relList.supports&&t.relList.supports("prefetch")}function D(t,e){e=l(),e.rel="prefetch",e.href=t,c.head.appendChild(e)}
